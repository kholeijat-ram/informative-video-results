<!DOCTYPE html>
<html>
<head>
<title>Quiz</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1 id="title"></h1>
  <p id="question"></p>
  <div id="options"></div>
  <p id="hint"></p>
  <button id="showSolution" onclick="showSolution()">Show Solution</button>
  <p id="solution"></p>
  <button onclick="nextQuestion()">Next Question</button>
</div>

<script>
let questions = [];
let currentIndex = 0;
let answers = [];

async function loadQuestions() {
  const unit = localStorage.getItem('unit');
  const difficulty = localStorage.getItem('difficulty');
  const email = localStorage.getItem('email');

  document.getElementById('title').innerText = `${unit} - ${difficulty} level`;

  const res = await fetch('questions.json');
  const data = await res.json();
  questions = data[unit][difficulty];

  nextQuestion();
}

function nextQuestion() {
  if (currentIndex >= questions.length) {
    saveResults();
    alert("Quiz finished! Thank you.");
    return;
  }

  const q = questions[currentIndex];
  document.getElementById('question').innerText = q.question;
  document.getElementById('hint').innerText = "";
  document.getElementById('solution').innerText = "";
  const optionsDiv = document.getElementById('options');
  optionsDiv.innerHTML = "";

  q.options.forEach(opt => {
    const btn = document.createElement('button');
    btn.innerText = opt;
    btn.onclick = () => selectAnswer(opt);
    optionsDiv.appendChild(btn);
  });
}

function selectAnswer(option) {
  answers.push({ question: questions[currentIndex].question, selected: option });
  document.getElementById('hint').innerText = "Hint: " + questions[currentIndex].hint;
}

function showSolution() {
  document.getElementById('solution').innerText = "Solution: " + questions[currentIndex].solution;
}

function saveResults() {
  const payload = {
    email: localStorage.getItem('email'),
    unit: localStorage.getItem('unit'),
    difficulty: localStorage.getItem('difficulty'),
    answers: answers
  };

  // Example: send to Google Apps Script endpoint
  fetch('YOUR_GOOGLE_SCRIPT_URL', {
    method: 'POST',
    body: JSON.stringify(payload)
  });
}

loadQuestions();
</script>

</body>
</html>
